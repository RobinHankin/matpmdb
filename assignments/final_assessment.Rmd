---
title: "The Gaussian distribution"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(include = FALSE)  # change to TRUE when rendering solutions; this changes
                                       # the default visibility (which is overridden by explicitly
                                       # setting  include=TRUE in chunk options) 

```

# Final assessment:  stat601/stat805/comp616

This assessment requires you to use R to demonstrate your
understanding of probability and statistics.  Answer each question and
show your working, including your R code.  There are five questions,
each of 20 marks.


## Question 1

Student's soda drinking habits are being studied at a schoool.  The
probability of a student drinking coke is 0.4; and the probability of
a student drinking pepsi is known to be 0.3.  If the probability of
drinking both is known to be 0.25, calculate:

* the probability of not drinking coke
* the probability of drinking either coke or pepsi, or both
* the probability of a student drinking coke, given that they
* Are drinking coke and pepsi independent?  Justify
* (excellence) a group of 20 randomly selected students attend a
  special seminar on healthy eating, which would be expected to
  decrease the likelihood of drinking soda.  After the seminar, these
  20 students are questioned and 15 drink neither coke nor pepsi and
  drink only water.  State a sensible null hypothesis, test it, and
  interpret.



```{r}
1-0.4 # not coke
```

## Question 2

A vetinarian is investigating a particular disease of cows.  She is
interested in whether English cows differ from Scottish cows in their
probability of suffering from this particular disease.  A sample of 15
cows is taken, of which 9 are English and 6 are Scottish.  It is not
known if English cows are more or less likely to have this disease.
In the sample, there are 10 healthy cows, of which 8
are English.  We may represent the data in R as follows:
  

```{r,include=TRUE}
x <- 8  # healthy English (white drawn)
k <- 9  # English (drawn)
n <- 5  # diseased (black)
m <- 10 # healthy (white)

a <- matrix(c(x,k-x,m-x,n-k+x),2,2)
dimnames(a) <- list(
    country=c("England","Scotland"),state=c("healthy","diseased")
)
a
```

  * State a sensible null hypothesis
  * State the precise definition of $p$-value and explain what
    ``more extreme'' means in this context
  * Is a one-sided or two-sided test needed? justify
  * Perform a Fisher test using `fisher.test()` and interpret
  * Estimate the probability of: (a), an English, and (b), a
    Scottish cow, having the disease
  * give a 95\% confidence interval for the probabilities of English and Scottish cows having the disease (you may use the normal approximation)
  * excellence: verify your $p$-value given by `fisher.test()` using `dhyper()` directly.     


```{r}
fisher.test(a)
f <- function(a,b){qnorm(c(0.025,0.5,0.975),a/(a+b),sqrt((a*b)/(a+b)^3))}

f(x,m-x)      # English
c(healthy=k-x,diseased=n-k+x)
f(k-x,n-k+x)  # Scottish

```

## Question 3

A computer scientist in Auckland has a large number of computers in
his laboratory and suspects that more failures occur when the
temperature outside is higher.

He collects data on 23 days:


```{r,include=TRUE}
temp <- c(17.1, 19.2, 15.2, 18.1, 15, 17.8, 17.8, 15.2, 17.4, 15.7, 17.8, 
16.9, 17.1, 17, 18, 15.9, 16.5, 17.3, 16.7, 15.9, 16.1, 19, 16)
fail <- c(28, 30, 27, 33, 27, 34, 31, 29, 29, 26, 33, 31, 27, 31, 32, 
28, 30, 33, 32, 26, 30, 34, 27)
```

Above, `temp` is the temperature in centigrade, and `fail` the number
of failures on each day.

  * State a sensible null hypothesis
  * State the precise definition of $p$-value and explain what
    ``more extreme'' means in this context
  * Is a one-sided or two-sided test needed? justify
  * Perform a linear regression using R and interpret.  Is there
    evidence that more computer failures occur during hotter weather?


```{r}
plot(fail~temp,xlab="temperature (C)",ylab="failures")
fit <- lm(fail~temp)
abline(fit)
summary(fit)  # one-sided test [slope of curve >0]; halve p-value
```


## Question 4

Around 37 degrees Centigrade. is normal body temperature for children
and adults.  _Fever_ is when your core body temperature is higher than
38 degrees centigrade.  A certain medicine that aims to reduce body
temperature has been applied to 80 patients that had a fever.  The
temperatures after the medicine was administrated are the following:


```{r,include=TRUE}
y  <-  scan( text = "
37.3 37.5 37.2 38.0 37.6 37.2 37.6 37.7 37.7 37.4 37.9 37.6 37.3
36.8 37.8 37.5 37.5 37.8 37.7 37.7 37.8 37.7 37.5 36.9 37.7 37.5
37.4 37.0 37.3 37.6 37.9 37.5 37.6 37.5 37.1 37.4 37.4 37.5 37.8
37.7 37.4 37.4 37.7 37.7 37.3 37.3 37.6 37.7 37.5 37.8 37.6 37.3
37.6 37.2 37.9 38.1 37.4 37.2 37.7 37.4 38.2 37.5 37.7 37.5 37.3
37.5 36.9 37.9 37.5 38.1 37.6 37.3 37.7 37.2 37.1 37.6 37.4 37.5
37.5 37.3")
```

We consider that the medicine is _effective_ if the temperature is
lower or equal to 38.  Perform a Bayesian analysis assuming a
skeptical position: we seek the probability that the medicine is
effective.

* Define the random variable and its distribution.
* Define the prior and justify your choice.
* Define the posterior distribution.
* Plot the prior and posterior in a graph.  Comment on it.
* Calculate a 95% credible interval and interpret it.


```{r}
# we seek p, the probability that T<38
table(y<38)
## uniform prior, alpha=beta=1:
p <- seq(from=0,to=1,len=500)
alpha <- 1
beta <- 1
plot(p,dbeta(p,alpha,beta),type='l',col='black',ylim=c(0,20))
points(p,dbeta(p,alpha + 76 ,beta+4),type='l',col='red')
legend("topleft",lty=1,col=c("black","red"),legend=c("prior","posterior"))
```


